<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

    <!-- ================= FREIGHT ================= -->
    <chart name="svh.chart.revenue.freight"
           title="Грузовые АТС — доход по дням">
        <search-fields>
            <field name="fromDateTime" type="datetime"/>
            <field name="toDateTime" type="datetime"/>
        </search-fields>
        <dataset type="jpql">
            <![CDATA[
                SELECT self.createdOn AS day, SUM(self.calculated_amount) AS amount
                FROM com.axelor.apps.svh.db.Registration self
                WHERE self.createdOn BETWEEN :fromDateTime AND :toDateTime
                  AND self.transport_type = 'FREIGHT'
                GROUP BY self.createdOn
                ORDER BY self.createdOn
            ]]>
        </dataset>
        <category key="day" type="date"/>
        <series key="amount" type="bar" title="Доход"/>
        <config name="colors" value="#1f77b4"/>
    </chart>

    <!-- ================= SPECIAL ================= -->
    <chart name="svh.chart.revenue.special"
           title="Спецтехника — доход по дням">
        <search-fields>
            <field name="fromDateTime" type="datetime"/>
            <field name="toDateTime" type="datetime"/>
        </search-fields>
        <dataset type="jpql">
            <![CDATA[
                SELECT self.createdOn AS day, SUM(self.calculated_amount) AS amount
                FROM com.axelor.apps.svh.db.Registration self
                WHERE self.createdOn BETWEEN :fromDateTime AND :toDateTime
                  AND self.transport_type = 'SPECIAL'
                GROUP BY self.createdOn
                ORDER BY self.createdOn
            ]]>
        </dataset>
        <category key="day" type="date"/>
        <series key="amount" type="pie" title="Доход"/>
        <config name="colors" value="#ff7f0e"/>
    </chart>

    <!-- ================= CAR CARRIER ================= -->
    <chart name="svh.chart.revenue.car_carrier"
           title="Автовозы — доход по дням">
        <search-fields>
            <field name="fromDateTime" type="datetime"/>
            <field name="toDateTime" type="datetime"/>
        </search-fields>
        <dataset type="jpql">
            <![CDATA[
                SELECT self.createdOn AS day, SUM(self.calculated_amount) AS amount
                FROM com.axelor.apps.svh.db.Registration self
                WHERE self.createdOn BETWEEN :fromDateTime AND :toDateTime
                  AND self.transport_type = 'CAR_CARRIER'
                GROUP BY self.createdOn
                ORDER BY self.createdOn
            ]]>
        </dataset>
        <category key="day" type="date"/>
        <series key="amount" type="area" title="Доход"/>
        <config name="colors" value="#2ca02c"/>
    </chart>

    <!-- ================= PASSENGER ================= -->
    <chart name="svh.chart.revenue.passenger"
           title="Легковые авто — доход по дням">
        <search-fields>
            <field name="fromDateTime" type="datetime"/>
            <field name="toDateTime" type="datetime"/>
        </search-fields>
        <dataset type="jpql">
            <![CDATA[
                SELECT self.createdOn AS day, SUM(self.calculated_amount) AS amount
                FROM com.axelor.apps.svh.db.Registration self
                WHERE self.createdOn BETWEEN :fromDateTime AND :toDateTime
                  AND self.transport_type = 'PASSENGER'
                GROUP BY self.createdOn
                ORDER BY self.createdOn
            ]]>
        </dataset>
        <category key="day" type="date"/>
        <series key="amount" type="pie" title="Доход"/>
        <config name="colors" value="#d62728"/>
    </chart>

    <!-- ================= COMPANY CAR ================= -->
    <chart name="svh.chart.revenue.company_car"
           title="Служебные авто — доход по дням">
        <search-fields>
            <field name="fromDateTime" type="datetime"/>
            <field name="toDateTime" type="datetime"/>
        </search-fields>
        <dataset type="jpql">
            <![CDATA[
                SELECT self.createdOn AS day, SUM(self.calculated_amount) AS amount
                FROM com.axelor.apps.svh.db.Registration self
                WHERE self.createdOn BETWEEN :fromDateTime AND :toDateTime
                  AND self.transport_type = 'COMPANY_CAR'
                GROUP BY self.createdOn
                ORDER BY self.createdOn
            ]]>
        </dataset>
        <category key="day" type="date"/>
        <series key="amount" type="pie" title="Доход"/>
        <config name="colors" value="#9467bd"/>
    </chart>

</object-views>
